!function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var i=n(8),o=n(12),a=n(3);n(9),n(6),n(7),$(function(){function e(e){return e%400===0||e%100!==0&&e%4===0}var t=i.val("pltId");t&&$(".navbar").children("#back").tap(function(e){e.preventDefault(),history.go(-1)}).end().show();var n=o.get(a.app),r=n?JSON.parse(decodeURIComponent(n)):{},s=r.zyData||{},l=s.zyUsers||{},c=s.currUser;if(zyInfo=l[c]){$(".name").text(zyInfo.name),$(".area").text(zyInfo.areaName+"/"+zyInfo.sickBed+"床"),$(".time").text(zyInfo.zyDate),$(".user-info").children(".switch-user").tap(function(e){e.preventDefault(),location.href="hsp_account?pltId="+t}).end().show();for(var d={hospitalCode:a.HSPCODE,zyFlow:zyInfo.zyFlow},p=new Date,u=p.getFullYear(),h=p.getMonth()+1,f=(p.getDate(),0),g=$(".select-year"),m=$(".select-month"),v=$(".select-date");f++<7;)$("<option></option>").text(u-f+1).appendTo(g);for(var _=[31,28+(e(u)?1:0),31,30,31,30,31,31,30,31,30,31],x=0,S=_[h-1];x++<S;)$("<option></option>").addClass("date-opt").text(x).appendTo(v);g.add(m).on("change",function(t){var n=+g.val(),i=+m.val(),o=([31,28+(e(n)?1:0),31,30,31,30,31,31,30,31,30,31],_[i-1]);if(o!==S){S=o,$(".date-opt").not(".default").remove();for(var a=0;a++<S;)$("<option></option>").addClass("date-opt").text(a).appendTo(v)}});var y=$(".loading"),I=$(".alert-window"),E=$(".alert-wrap.input-invalid");E.bindTouchHandler(".confirm",function(e){e.preventDefault(),E.close()}),$(".search-btn").on("touchend",function(e){var t=$(".default").filter(function(){return $(this).prop("selected")}),n=!t.length;if(n){var i=new Date;i.setDate(v.val()),i.setMonth(m.val()-1),i.setFullYear(g.val()),d.beginDate=i.format("yyyy-mm-dd");var o=new Date(i.getTime()+864e5);d.endDate=o.format("yyyy-mm-dd"),$(".detail-wrap").hide(),$(".item.template").siblings().remove(),$(".count-item").children("span").text(""),$.ajax({url:a.GetDataURL,type:"get",data:{mName:"getZYBillDetailList",pContent:JSON.stringify(d)},beforeSend:function(){y.show()},complete:function(e){y.hide();var t=e.responseText?e.responseText.trim():"";if(""===t||a.rhtml.test(t))alert(a.NET_ERROR);else{var n=JSON.parse(t);if("1"!==n.rspCode)I.alert(n.rspMsg,!0);else{$(".search-wrap").hide();var i=n.rspData,o=i.body,r=0,s=o.length,l=$(".item.template"),c=l.clone().removeClass("template");$(".area").text(i.areaName),$(".name").text(i.name||oTransData.name),$(".code").text(zyInfo.zyFlow),$(".position").text(i.sickBed),$(".count").text(i.curDateFee+"元"),$(".sum").text(i.totalFee+"元"),$(".foregift").text(i.hpmsFee+"元"),$(".balance").text(i.remainFee+"元");for(var d=$('<span class="fold-btn"><span class="fold-arrow"></span></span>'),p=$('<table class="item-detail"><thead><tr><th>项目名称</th><th>单价</th><th>数量</th><th>金额</th></tr></thead><tbody></tbody></table>'),u=$('<tr><td class="item-name"></td><td class="item-unit"></td><td class="item-count"></td><td class="item-sum"></td></tr>');s>r;r++){var h=o[r],f=h.itemList,g=f.length,m=0,v=c.clone().toggleClass("folding",!!g);if(g){for(var _=p.clone();g>m;m++){var x=f[m];u.clone().find(".item-name").text(x.itemName).end().find(".item-unit").text(x.units).end().find(".item-count").text(x.amount).end().find(".item-sum").text(x.charges).end().appendTo(_)}d.clone().appendTo(v.children(".item-brief")),_.appendTo(v)}v.find(".brief-name").text(h.mFeeName).end().find(".brief-value").text(h.charges+"元").end().insertBefore(l)}$(".item.folding").tap(function(e,t){$(t).toggleClass("unfold")}),$(".detail-wrap").show()}}}})}else E.open("","请"+t.first().text())})}else location.href="hsp_sign_in?referrer=hsp_daily_bill&pltId="+t})},function(e,t){String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")}),e.exports={defaults:{},extend:function(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var i in n)t[i]=n[i]}return t},cookie:function(e,t,n){if(void 0!==t){if(e.match(/\W/))throw new Error("characters out bounds of [0-9a-zA-Z_] are illegal");var n=n||this.defaults;if("number"==typeof n.expires){var i=new Date;return i.setTime(+i+864e5*n.expires),document.cookie=[e,"=",t,n.expires?"; expires="+i.toGMTString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}}for(var o=document.cookie,a=o.split(";"),r=0,s=a.length;s>r;r++){var l=a[r].trim(),c=l.indexOf("=");if(l.slice(0,c)===e)return l.slice(c+1)}return""},add:function(e,t,n){this.cookie(e,t,n)},get:function(e){return this.cookie(e)},remove:function(e,t){this.cookie(e,"invalid",this.extend(t,{expires:-1}))},removeAll:function(e){for(var t=document.cookie,n=t.split(";"),i=0,o=n.length;o>i;i++){var a=n[i].split("=")[0].trim();this.remove(a,e)}}}},,function(e,t,n){var i=n(4),o={app:"glwx",pltId:"03",productId:"010",version:"1.00.00",wxAppId:"wx97e1952c1a0281a4",GetDataURL:location.origin+"/support/get_data",appColumnsMap:{"001":{cols:[{nodeId:225,level:1,title:"健康科普",thumbnail_path:"/assets/glwx/img/thumbnail.png"},{nodeId:229,level:1,title:"营养养生",thumbnail_path:"/assets/glwx/img/thumbnail.png"},{nodeId:230,level:1,title:"通知公告",thumbnail_path:"/assets/glwx/img/thumbnail.png"}],style_extensions:"condensed color-inverse",article_based:!0,article_cols:[{nodeId:238,bRecm:!0,style_extensions:"float first-stressed"},{nodeId:239}]},"007":{cols:[{nodeId:93,level:1,title:"医院动态"},{nodeId:94,level:1,title:"学科动态"},{nodeId:89,level:1,title:"健康科普"},{nodeId:90,level:1,title:"媒体报道"}],style_extensions:"first-stressed"}},HSPCODE:"23101",HSPNAME:"南京市鼓楼医院",DEFAULT_MAX_INTRO_LENGTH:25,MAX_SEARCH_TIMES:10,DEFAULT_HOS_LOGO_IMG_SRC:"/assets/gcwx/img/hsp_logo_default.png",DEFAULT_DOC_IMG_SRC:"/assets/gcwx/img/doc_default.png",DEFAULT_HSP_IMG_SRC:"/assets/gcwx/img/hsp_default.png",SEND_DEFAULT:"点击发送验证码",SENDING:"验证码发送中",SEND_SUCCESS:"输入验证码",SEND_FAILED:"发送失败点击重发"};for(var a in i)o[a]=i[a];o.ajaxSetting({redirectPageName:"sign_in",redirectExcept:["sign_in","sign_up","validate","forget","home_info","info_list","hsp_sign_in","hsp_home","hsp_account","hsp_foregift","hsp_daily_bill"]}),e.exports=o},function(e,t,n){n(5);var i={NET_ERROR:"网络连接错误，请刷新重试！",GET_DATA_ERROR:"数据请求异常",COOKIE_NOT_AVAILABLE:"Cookie当前不可用！请检查浏览器设置",rhtml:/^<(?:\s|.)*>$/,IS_WX:/MicroMessenger/i.test(navigator.userAgent),ajaxSetting:function(e){if(window.$&&$.ajaxSetup){var t=location.pathname.match(/(\/(?:\w+\/)*)(\w+)?/),i=e.redirectPageName,o=this;t&&(pageName=t[2])&&(i+=[location.search?location.search+"&":"?","referrer="+pageName].join("")),$.ajaxSetup({dataType:"json",data:{pltId:this.pltId,productId:this.productId,version:this.version,sessionId:n(1).get("sid")},success:function(t,n){if("1"!==t.rspCode)switch(t.rspCode){case"9004":case"9005":e.sidHandler?e.sidHandler():location.href=o.IS_WX?o.getWxAuthPath(i):i}},complete:function(e,t){var n=e.responseText&&e.responseText.trim();if(""===n||o.rhtml.test(n))switch(t){case"success":alert(o.GET_DATA_ERROR);break;case"error":alert(o.NET_ERROR);break;case"abort":break;default:console.log(t),this._error&&this._error.call(this,t)}else try{this._complete&&this._complete.call(this,JSON.parse(n))}catch(i){console.log(i)}}})}},getFullPath:function(e){var t=location.pathname.match(/(\/(?:\w+\/)*)(?:\w+)?/)[1];return[location.origin,t,e].join("")},getWxAuthPath:function(e){return"https://open.weixin.qq.com/connect/oauth2/authorize?appid="+this.wxAppId+"&redirect_uri="+encodeURIComponent(this.getFullPath(e))+"&response_type=code&scope=snsapi_base#wechat_redirect"},ModifyCommonUser:{ADD:"1",UPDATE:"2",DELETE:"3"},RegisterType:{REGISTER:"1",FETCH:"2",CHARGE:"3"},RegisterTypeMap:{1:"挂号",2:"取号",3:"缴费"},BusinessType:{REGISTER:"1",RESET_PASSWORD:"2",CASE_HISTORY:"3",RESERVE_RECORD:"4",SEE_REPORT:"5"},PayMethod:{TELE_FARE:"00",ONLINE_PAY:"01",UNION_WAP_PAY:"010",ALI_PAY:"02",WX_PAY:"03",OFFLINE_PAY:"05"},ChannelCode:{BD:"01",WX:"02",ALI:"03",YM:"04"},CardTypes:["医疗卡","医保卡"],ReportPrintStatus:["未打印","已打印","检测中"],Status:["已违约","已取消","取号/挂号成功","预约可取消","预约不可取消","可支付","预约成功","业务处理中/挂号处理中","挂号失败","已退号","历史挂号记录"],Weekdays:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],SeeTimeStrings:["上午","中午","下午","夜晚","早班","全天"],NORMAL:"普通号",INFO_IMG_SRC:"http://cms.jiankang51.cn",COUNTDOWN_MINUTES:60};e.exports=i},function(e,t){String.prototype.startsWith||(String.prototype.startsWith=function(e){return this.slice(0,e.length)==e}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")})},function(e,t){!function(e){e.fn.tap=function(t){return this.each(function(){var n=e(this),i=/mobile|windows phone|ios|android/i.test(navigator.userAgent);if(t)if(i){var o,a,r,s;n.on("touchstart",function(e){var t=e.originalEvent.touches[0];o=t.pageX,r=t.pageY}),n.on("touchend",function(e){if(e=e.originalEvent,"function"==typeof t)if(e){var n=e.changedTouches[0];a=n.pageX,s=n.pageY,Math.abs(a-o)<6&&Math.abs(s-r)<6&&t.call(this,e,this)}else t.call(this,e,this)})}else n.on("click",function(e){t.call(this,e,this)});else n.triggerHandler(i?"touchend":"click")}),this}}(jQuery)},function(e,t){!function(e){e.fn.extend({alert:function(t,n,i){var o=e(this);o.find(".alert-window-info").text(t),n&&o.addClass("failed"),o.ajustToCenter().fadeIn(250),setTimeout(function(){o.fadeOut(250,function(){i&&i(),o.removeClass("failed")})},2e3)},ajustToCenter:function(){var t=e(this);return t.css({top:function(){return e("body").scrollTop()+e(window).height()/2-t.height()/2},margin:"0 auto"})},open:function(t,n,i){var o=e(this);return t&&o.find(".alert-title").text(t),n&&o.find(".alert-desc").text(n),o.show(),i&&"function"==typeof i&&i(),o},close:function(){return e(this).hide()},bindTouchHandler:function(t,n,i){var o={};return this.each(function(){var i=e(this),a=o.toString.call(t).match(/\[object (\w+)\]/)[1].toLowerCase(),r=/mobile|windows phone|ios|android/i.test(navigator.userAgent),s=r?"touchend":"click";if("object"===a)for(var l in t){var c=t[l];i.find(l).on(s,{$elem:i},c)}else"string"===a&&i.find(t).on(s,{$elem:i},n)}),this}})}(jQuery)},function(e,t){e.exports={val:function(e,t){var n=decodeURIComponent(location.search),i=-1!==n.indexOf("#")?n.indexOf("#"):n.length,o=n?n.slice(1,i):null,a={},r=a.toString,s=[];if(o)for(var l=o.split("&"),c=0,d=l.length;d>c;c++){var p=l[c],u=p.indexOf("=");a[p.slice(0,u)]=p.slice(u+1)}if(void 0===e)return a;if(void 0!==t)a[e]=t;else{if("string"==typeof e)return a[e]||"";if("[object Object]"!==r.call(e))return"";for(var h in e)a[h]=e[h]}for(var h in a)s.push(h+"="+a[h]);location.search="?"+encodeURIComponent(s.join("&"))}}},function(e,t){Date.prototype.format=function(e){for(var t=e.split(/[^a-zA-Z]/),n=0,i=t.length,o={yyyy:this.getFullYear(),mm:this.getMonth()+1,dd:this.getDate(),hh:this.getHours(),MM:this.getMinutes(),ss:this.getSeconds()};i>n;n++){var a=t[n],r=o[a];a in o&&(e=e.replace(a,10>r?"0"+r:r))}return e},String.prototype.toDate=function(e){var t=new Date;if(/^\d*$/.test(this))t.setDate(this.slice(6,8)),t.setMonth(parseInt(this.slice(4,6))-1),t.setFullYear(this.slice(0,4));else if(e=e||this.match(/[^\w]/)[0]){var n=this.split(e);t.setDate(n[2]),t.setMonth(parseInt(n[1])-1),t.setFullYear(n[0])}return t},Date.prototype.isSameDayWith=function(e){return e?this.getDate()===e.getDate()&&this.getMonth()===e.getMonth()&&this.getFullYear()===e.getFullYear():!1}},,,function(e,t,n){var i=n(1);e.exports={bLS:!!window.localStorage&&!/android/i.test(navigator.userAgent),add:function(e,t,n){return this.bLS?localStorage.setItem(e,t):i.add(e,t,n)},get:function(e){return this.bLS?localStorage.getItem(e):i.get(e)},remove:function(e){return this.bLS?localStorage.removeItem(e):i.remove(e)},clear:function(){return this.bLS?localStorage.clear():i.removeAll()}}}]);