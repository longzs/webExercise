!function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){var n=i(1),r=i(2),o=i(3);i(9),i(6),i(7),$(function(){var e=n.get("idnum");if(e){e=r.decode(e);var t=(r.decode(n.get("name")),$(".loading.record-loading")),i=$(".alert-window"),a=($(".overlayer"),{hospitalCode:o.HSPCODE,userId:e,typeId:"0"}),s=$(".cancel-prompt"),l=$(".cancel-result"),d=$(".loading.cancel-loading"),c={};s.bindTouchHandler({".cancel":function(){s.close()},".confirm":function(){s.close(),$.ajax({url:o.GetDataURL,type:"get",data:{mName:"preRegisterCancel",pContent:JSON.stringify(c)},beforeSend:function(){d.show()},complete:function(e){d.hide();var t=e.responseText?e.responseText.trim():"";if(""===t||o.rhtml.test(t))alert(o.NET_ERROR);else{var i=JSON.parse(t);"1"!==i.rspCode?l.open("",i.rspMsg):l.open("","预约取消成功")}}})}}),l.bindTouchHandler({".confirm":function(){location.reload()}}),$(".cancel-btn").on("touchend",function(t){t.stopPropagation();var i=$(this);if(!i.is(".disabled")){var n=i.closest(".order"),r=n.data("orderInfo");c={hospitalCode:o.HSPCODE,userId:e,preRegisterFlow:r.registerFlow,reservationFrom:r.reservationFrom},s.open()}}),$(".order").tap(function(e){var t=$(this),i=$(e.target),n=t.data("orderInfo");if(i.is(".reserve-btn")){var r={hspCode:n.hospitalCode,hspName:n.hospitalName,depId:n.departmentId,depName:n.departmentName};n.expertId?($.extend(r,{expertId:n.expertId,expertName:n.expertName,expertTitle:n.expertTitle,expertImg:n.imgUrl}),location.href="doctor_info?transData="+encodeURIComponent(JSON.stringify(r))):location.href="select_doctor?transData="+encodeURIComponent(JSON.stringify(r))}else if(i.is(".pay-btn")){var a={hspCode:n.hospitalCode,depId:n.departmentId,depName:n.departmentName,clinicDate:n.clinicDate,seeTime:n.seeTime,scheduFlow:n.registerFlow,totalFee:n.totalFee,sectionId:n.sectionId,reservationFrom:n.reservationFrom,idNo:n.idNo,bRegister:1,typeId:o.RegisterType.FETCH};n.expertId?$.extend(a,{expertId:n.expertId,expertName:n.expertName,expertTitle:n.expertTitle,imgURL:n.imgUrl}):$.extend(a,{expertName:o.NORMAL}),location.href="place_order?transData="+encodeURIComponent(JSON.stringify(a))}else n.bHistory=t.is(".history"),location.href="register_info?transData="+encodeURIComponent(JSON.stringify(n))}),$.ajax({url:o.GetDataURL,type:"get",data:{mName:"searchUserRegisterInfo",pContent:JSON.stringify(a)},beforeSend:function(){t.show()},complete:function(e){t.hide();var n=e.responseText?e.responseText.trim():"";if(""===n||o.rhtml.test(n))alert(o.NET_ERROR);else{var r=JSON.parse(n);if("1"!==r.rspCode)i.alert(r.rspMsg,!0);else{var a=r.rspData.body,s=$(".order.template"),l=s.clone(!0).removeClass("template"),d=0,c=a.length,p={1:"register",2:"reserve"};if(c)for(;c>d;d++){var h=l.clone(!0),f=a[d],u=f.seeTime,g=1==u.length?o.SeeTimeStrings[parseInt(u)-1]:u;if(h.toggleClass("history",!!+f.isHistory),"2"===f.typeId)if(+f.isHistory){var m=o.Status[f.status];h.find(".visit-state").text(m).toggle(!!m)}else{var v=(new Date).getTime(),x=f.clinicDate.toDate().getTime(),_=(x-v)/864e5|0;if(_>0)h.find(".cancel-btn").toggleClass("disabled",!+f.cancelFlag).show().end().find(".day-left").children(".left-days").text(_+"天").end().show();else if(0==_){h.find(".no-left").show();var I=0,S=!1,C=new Date,y=(C.getHours()<10?"0"+C.getHours():C.getHours())+":"+(C.getMinutes()<10?"0"+C.getMinutes():C.getMinutes());2===g.length?"下午"===g&&(I=1):g.indexOf(":")&&"3"===u&&(I=1),S=I?-1==="17:00".localeCompare(y):-1==="11:30".localeCompare(y),"5"===f.status&&h.addClass("pay-needed")}else{var m=o.Status[f.status];h.addClass("history").find(".visit-state").text(m).toggle(!!m)}}else+f.isHistory?h.find(".visit-state").text("已就诊").show():h.find(".visit-state").text("今日就诊").show();h.addClass(p[f.typeId]).find(".doc-name").text(f.expertName||o.NORMAL).end().find(".dep-name").text(f.departmentName).end().find(".visit-time").text(f.clinicDate+" "+o.Weekdays[f.clinicDate.toDate().getDay()]+" "+g).end().find(".visitor-name").text(f.name).end().find(".charge").text(f.totalFee).end().find(".order-no").text(f.orderNo).end().find(".verify-code").text(f.verifyCode).end().data("orderInfo",f).insertBefore(s)}else $(".no-result").show()}}}})}else location.href=o.IS_WX?o.getWxAuthPath("sign_in?referrer=my_register"):"sign_in?referrer=my_register"})},function(e,t){String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")}),e.exports={defaults:{},extend:function(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t},cookie:function(e,t,i){if(void 0!==t){if(e.match(/\W/))throw new Error("characters out bounds of [0-9a-zA-Z_] are illegal");var i=i||this.defaults;if("number"==typeof i.expires){var n=new Date;return n.setTime(+n+864e5*i.expires),document.cookie=[e,"=",t,i.expires?"; expires="+n.toGMTString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}}for(var r=document.cookie,o=r.split(";"),a=0,s=o.length;s>a;a++){var l=o[a].trim(),d=l.indexOf("=");if(l.slice(0,d)===e)return l.slice(d+1)}return""},add:function(e,t,i){this.cookie(e,t,i)},get:function(e){return this.cookie(e)},remove:function(e,t){this.cookie(e,"invalid",this.extend(t,{expires:-1}))},removeAll:function(e){for(var t=document.cookie,i=t.split(";"),n=0,r=i.length;r>n;n++){var o=i[n].split("=")[0].trim();this.remove(o,e)}}}},function(e,t){e.exports={b64:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){if(!e)return"";e=encodeURIComponent(e);var t,i,n,r,o,a,s,l,d=this.b64,c=0,p=e.length,h=[],f=0;do t=e.charCodeAt(c++),i=e.charCodeAt(c++),n=e.charCodeAt(c++),r=t<<16|i<<8|n,o=r>>18&63,a=r>>12&63,s=r>>6&63,l=63&r,h[f++]=d.charAt(o)+d.charAt(a)+d.charAt(s)+d.charAt(l);while(p>c);var u=h.join(""),g=p%3;return(g?u.slice(0,g-3):u)+"===".slice(g||3)},decode:function(e){if(!e)return"";if(!/^(?:[a-zA-Z\d\+\/=]{4})*$/.test(e))throw new Error("invalid base64 string");var t,i,n,r,o,a,s,l,d=this.b64,c=0,p=e.length,h=[],f=0;do t=d.indexOf(e.charAt(c++)),i=d.indexOf(e.charAt(c++)),n=d.indexOf(e.charAt(c++)),r=d.indexOf(e.charAt(c++)),o=t<<18|i<<12|n<<6|r,a=o>>16&255,s=o>>8&255,l=255&o,64==n?h[f++]=String.fromCharCode(a):64==r?h[f++]=String.fromCharCode(a,s):h[f++]=String.fromCharCode(a,s,l);while(p>c);return decodeURIComponent(h.join(""))}}},function(e,t,i){var n=i(4),r={app:"glwx",pltId:"03",productId:"010",version:"1.00.00",wxAppId:"wx97e1952c1a0281a4",GetDataURL:location.origin+"/support/get_data",appColumnsMap:{"001":{cols:[{nodeId:225,level:1,title:"健康科普",thumbnail_path:"/assets/glwx/img/thumbnail.png"},{nodeId:229,level:1,title:"营养养生",thumbnail_path:"/assets/glwx/img/thumbnail.png"},{nodeId:230,level:1,title:"通知公告",thumbnail_path:"/assets/glwx/img/thumbnail.png"}],style_extensions:"condensed color-inverse",article_based:!0,article_cols:[{nodeId:238,bRecm:!0,style_extensions:"float first-stressed"},{nodeId:239}]},"007":{cols:[{nodeId:93,level:1,title:"医院动态"},{nodeId:94,level:1,title:"学科动态"},{nodeId:89,level:1,title:"健康科普"},{nodeId:90,level:1,title:"媒体报道"}],style_extensions:"first-stressed"}},HSPCODE:"23101",HSPNAME:"南京市鼓楼医院",DEFAULT_MAX_INTRO_LENGTH:25,MAX_SEARCH_TIMES:10,DEFAULT_HOS_LOGO_IMG_SRC:"/assets/gcwx/img/hsp_logo_default.png",DEFAULT_DOC_IMG_SRC:"/assets/gcwx/img/doc_default.png",DEFAULT_HSP_IMG_SRC:"/assets/gcwx/img/hsp_default.png",SEND_DEFAULT:"点击发送验证码",SENDING:"验证码发送中",SEND_SUCCESS:"输入验证码",SEND_FAILED:"发送失败点击重发"};for(var o in n)r[o]=n[o];r.ajaxSetting({redirectPageName:"sign_in",redirectExcept:["sign_in","sign_up","validate","forget","home_info","info_list","hsp_sign_in","hsp_home","hsp_account","hsp_foregift","hsp_daily_bill"]}),e.exports=r},function(e,t,i){i(5);var n={NET_ERROR:"网络连接错误，请刷新重试！",GET_DATA_ERROR:"数据请求异常",COOKIE_NOT_AVAILABLE:"Cookie当前不可用！请检查浏览器设置",rhtml:/^<(?:\s|.)*>$/,IS_WX:/MicroMessenger/i.test(navigator.userAgent),ajaxSetting:function(e){if(window.$&&$.ajaxSetup){var t=location.pathname.match(/(\/(?:\w+\/)*)(\w+)?/),n=e.redirectPageName,r=this;t&&(pageName=t[2])&&(n+=[location.search?location.search+"&":"?","referrer="+pageName].join("")),$.ajaxSetup({dataType:"json",data:{pltId:this.pltId,productId:this.productId,version:this.version,sessionId:i(1).get("sid")},success:function(t,i){if("1"!==t.rspCode)switch(t.rspCode){case"9004":case"9005":e.sidHandler?e.sidHandler():location.href=r.IS_WX?r.getWxAuthPath(n):n}},complete:function(e,t){var i=e.responseText&&e.responseText.trim();if(""===i||r.rhtml.test(i))switch(t){case"success":alert(r.GET_DATA_ERROR);break;case"error":alert(r.NET_ERROR);break;case"abort":break;default:console.log(t),this._error&&this._error.call(this,t)}else try{this._complete&&this._complete.call(this,JSON.parse(i))}catch(n){console.log(n)}}})}},getFullPath:function(e){var t=location.pathname.match(/(\/(?:\w+\/)*)(?:\w+)?/)[1];return[location.origin,t,e].join("")},getWxAuthPath:function(e){return"https://open.weixin.qq.com/connect/oauth2/authorize?appid="+this.wxAppId+"&redirect_uri="+encodeURIComponent(this.getFullPath(e))+"&response_type=code&scope=snsapi_base#wechat_redirect"},ModifyCommonUser:{ADD:"1",UPDATE:"2",DELETE:"3"},RegisterType:{REGISTER:"1",FETCH:"2",CHARGE:"3"},RegisterTypeMap:{1:"挂号",2:"取号",3:"缴费"},BusinessType:{REGISTER:"1",RESET_PASSWORD:"2",CASE_HISTORY:"3",RESERVE_RECORD:"4",SEE_REPORT:"5"},PayMethod:{TELE_FARE:"00",ONLINE_PAY:"01",UNION_WAP_PAY:"010",ALI_PAY:"02",WX_PAY:"03",OFFLINE_PAY:"05"},ChannelCode:{BD:"01",WX:"02",ALI:"03",YM:"04"},CardTypes:["医疗卡","医保卡"],ReportPrintStatus:["未打印","已打印","检测中"],Status:["已违约","已取消","取号/挂号成功","预约可取消","预约不可取消","可支付","预约成功","业务处理中/挂号处理中","挂号失败","已退号","历史挂号记录"],Weekdays:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],SeeTimeStrings:["上午","中午","下午","夜晚","早班","全天"],NORMAL:"普通号",INFO_IMG_SRC:"http://cms.jiankang51.cn",COUNTDOWN_MINUTES:60};e.exports=n},function(e,t){String.prototype.startsWith||(String.prototype.startsWith=function(e){return this.slice(0,e.length)==e}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")})},function(e,t){!function(e){e.fn.tap=function(t){return this.each(function(){var i=e(this),n=/mobile|windows phone|ios|android/i.test(navigator.userAgent);if(t)if(n){var r,o,a,s;i.on("touchstart",function(e){var t=e.originalEvent.touches[0];r=t.pageX,a=t.pageY}),i.on("touchend",function(e){if(e=e.originalEvent,"function"==typeof t)if(e){var i=e.changedTouches[0];o=i.pageX,s=i.pageY,Math.abs(o-r)<6&&Math.abs(s-a)<6&&t.call(this,e,this)}else t.call(this,e,this)})}else i.on("click",function(e){t.call(this,e,this)});else i.triggerHandler(n?"touchend":"click")}),this}}(jQuery)},function(e,t){!function(e){e.fn.extend({alert:function(t,i,n){var r=e(this);r.find(".alert-window-info").text(t),i&&r.addClass("failed"),r.ajustToCenter().fadeIn(250),setTimeout(function(){r.fadeOut(250,function(){n&&n(),r.removeClass("failed")})},2e3)},ajustToCenter:function(){var t=e(this);return t.css({top:function(){return e("body").scrollTop()+e(window).height()/2-t.height()/2},margin:"0 auto"})},open:function(t,i,n){var r=e(this);return t&&r.find(".alert-title").text(t),i&&r.find(".alert-desc").text(i),r.show(),n&&"function"==typeof n&&n(),r},close:function(){return e(this).hide()},bindTouchHandler:function(t,i,n){var r={};return this.each(function(){var n=e(this),o=r.toString.call(t).match(/\[object (\w+)\]/)[1].toLowerCase(),a=/mobile|windows phone|ios|android/i.test(navigator.userAgent),s=a?"touchend":"click";if("object"===o)for(var l in t){var d=t[l];n.find(l).on(s,{$elem:n},d)}else"string"===o&&n.find(t).on(s,{$elem:n},i)}),this}})}(jQuery)},,function(e,t){Date.prototype.format=function(e){for(var t=e.split(/[^a-zA-Z]/),i=0,n=t.length,r={yyyy:this.getFullYear(),mm:this.getMonth()+1,dd:this.getDate(),hh:this.getHours(),MM:this.getMinutes(),ss:this.getSeconds()};n>i;i++){var o=t[i],a=r[o];o in r&&(e=e.replace(o,10>a?"0"+a:a))}return e},String.prototype.toDate=function(e){var t=new Date;if(/^\d*$/.test(this))t.setDate(this.slice(6,8)),t.setMonth(parseInt(this.slice(4,6))-1),t.setFullYear(this.slice(0,4));else if(e=e||this.match(/[^\w]/)[0]){var i=this.split(e);t.setDate(i[2]),t.setMonth(parseInt(i[1])-1),t.setFullYear(i[0])}return t},Date.prototype.isSameDayWith=function(e){return e?this.getDate()===e.getDate()&&this.getMonth()===e.getMonth()&&this.getFullYear()===e.getFullYear():!1}}]);